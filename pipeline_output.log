Running dataset pipeline demo...
PYTHONPATH=. venv/bin/python3 examples/dataset_pipeline_demo.py
======================================================================
Dataset Loading and Processing Pipeline Demo
======================================================================

1. Loading Bitext Retail Banking Dataset...
----------------------------------------------------------------------
2025-10-17 02:25:26,661 - chatbot_analytics.src.repositories.dataset_loaders - INFO - Loading Bitext dataset from Dataset/BitextRetailBanking/bitext-retail-banking-llm-chatbot-training-dataset.csv
2025-10-17 02:25:26,945 - chatbot_analytics.src.repositories.dataset_loaders - INFO - Loaded 25545 conversations from Bitext dataset
✓ Loaded 25545 conversations
  Total turns: 51090
  Unique intents: 26

2. Validating Data Quality...
----------------------------------------------------------------------
2025-10-17 02:25:26,962 - chatbot_analytics.src.services.data_validator - INFO - Bitext dataset contains Q&A pairs (2 turns per conversation)
2025-10-17 02:25:26,962 - chatbot_analytics.src.services.data_validator - INFO - Dataset validation passed for BitextRetailBanking
2025-10-17 02:25:26,976 - chatbot_analytics.src.services.data_validator - INFO - Quality assessment for BitextRetailBanking: Overall=1.00, Completeness=1.00, Consistency=1.00
✓ Validation: PASSED
  Errors: 0
  Warnings: 0
  Overall Quality: 100.00%
  Completeness: 100.00%
  Consistency: 100.00%

3. Analyzing Dataset Statistics...
----------------------------------------------------------------------
✓ Text Statistics:
  Avg text length: 481.1 chars
  Avg word count: 81.8 words
✓ Intent Distribution:
  Unique intents: 26
  - activate_card: 1000 examples
  - find_branch: 1000 examples
  - check_recent_transactions: 999 examples

4. Preprocessing Dataset...
----------------------------------------------------------------------
Original text: I would like to acivate a card, can you help me?...
2025-10-17 02:25:27,982 - chatbot_analytics.src.services.data_preprocessor - INFO - Preprocessed dataset BitextRetailBanking with 25545 conversations
Preprocessed: i would like to acivate a card, can you help me?...

5. Splitting Dataset for Training...
----------------------------------------------------------------------
2025-10-17 02:25:27,986 - chatbot_analytics.src.services.data_preprocessor - INFO - Split dataset BitextRetailBanking: train=17881, val=3831, test=3833
✓ Dataset split:
  Training: 17881 conversations (70.0%)
  Validation: 3831 conversations (15.0%)
  Test: 3833 conversations (15.0%)

6. Extracting Data for ML Tasks...
----------------------------------------------------------------------
✓ Intent classification dataset: 17881 examples
✓ User queries extracted: 17881

Sample classification example:
  Text: ineed assistance seeing the mortgage payment...
  Intent: check_mortgage_payments

7. Loading Schema-Guided Dialogue Dataset...
----------------------------------------------------------------------
2025-10-17 02:25:28,068 - chatbot_analytics.src.repositories.dataset_loaders - INFO - Loaded 727 conversations from Schema-Guided dataset
✓ Loaded 727 multi-turn conversations
  Total turns: 13654
  Avg turns per conversation: 18.8
✓ Conversations with 5+ turns: 727

Sample multi-turn conversation (16 turns):
  User: What's my balance?...
  Assistant: In checking or savings?...
  User: In checking....
  Assistant: Your checking account has $5,118.77....

8. Generating Comprehensive Quality Summary...
----------------------------------------------------------------------
2025-10-17 02:25:28,080 - chatbot_analytics.src.services.data_validator - INFO - Bitext dataset contains Q&A pairs (2 turns per conversation)
2025-10-17 02:25:28,080 - chatbot_analytics.src.services.data_validator - INFO - Dataset validation passed for BitextRetailBanking
2025-10-17 02:25:28,095 - chatbot_analytics.src.services.data_validator - INFO - Quality assessment for BitextRetailBanking: Overall=1.00, Completeness=1.00, Consistency=1.00
✓ Quality Summary Generated:
  Dataset: BitextRetailBanking
  Type: bitext
  Records: 25545
  Valid: 25545
  Quality Score: 100.00%

======================================================================
✓ Pipeline Demo Complete!
======================================================================

All dataset loading and processing components are working correctly.
The pipeline is ready for:
  - Intent classification model training
  - Conversation analysis
  - Multi-turn dialogue modeling
  - Quality assessment and monitoring
Training intent classifier...
venv/bin/python3 examples/train_intent_classifier.py
2025-10-17 02:25:31,219 - chatbot_analytics.__main__ - INFO - Loading BANKING77 dataset...
2025-10-17 02:25:31,219 - chatbot_analytics.src.repositories.dataset_loaders - WARNING - Could not load intent labels: Expecting value: line 9 column 1 (char 8). Using numeric labels.
2025-10-17 02:25:31,242 - chatbot_analytics.src.repositories.dataset_loaders - INFO - Loaded 13085 conversations from BANKING77 dataset
2025-10-17 02:25:31,242 - chatbot_analytics.__main__ - INFO - Loaded dataset with 13085 conversations
2025-10-17 02:25:31,243 - chatbot_analytics.__main__ - INFO - Found 78 unique intents
2025-10-17 02:25:31,243 - chatbot_analytics.__main__ - INFO - Splitting dataset into train/val/test sets...
2025-10-17 02:25:31,246 - chatbot_analytics.src.services.data_preprocessor - INFO - Split dataset BANKING77: train=9159, val=1962, test=1964
2025-10-17 02:25:31,246 - chatbot_analytics.__main__ - INFO - Train size: 9159
2025-10-17 02:25:31,246 - chatbot_analytics.__main__ - INFO - Validation size: 1962
2025-10-17 02:25:31,246 - chatbot_analytics.__main__ - INFO - Test size: 1964
2025-10-17 02:25:31,246 - chatbot_analytics.__main__ - INFO - Initializing intent classifier...
2025-10-17 02:25:31,246 - chatbot_analytics.src.models.intent_classifier - INFO - Initializing IntentClassifier with model: bert-base-uncased
2025-10-17 02:25:31,246 - chatbot_analytics.src.models.intent_classifier - INFO - Using device: cpu
2025-10-17 02:25:31,246 - chatbot_analytics.src.models.intent_classifier - INFO - GPU available: False
2025-10-17 02:25:31,246 - chatbot_analytics.src.models.intent_classifier - INFO - Batch size: 32
2025-10-17 02:25:31,246 - chatbot_analytics.src.models.intent_classifier - INFO - Cache enabled: True (size: 1000)
2025-10-17 02:25:31,246 - chatbot_analytics.__main__ - INFO - Starting training...
2025-10-17 02:25:31,246 - chatbot_analytics.src.models.intent_classifier - INFO - Starting model training
2025-10-17 02:25:31,247 - chatbot_analytics.src.models.intent_classifier - INFO - Created label mappings for 78 intents
2025-10-17 02:25:31,247 - chatbot_analytics.src.models.intent_classifier - INFO - Loading tokenizer and model: bert-base-uncased
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-10-17 02:25:31,881 - chatbot_analytics.src.models.intent_classifier - INFO - Converting datasets to HuggingFace format
2025-10-17 02:25:31,890 - chatbot_analytics.src.models.intent_classifier - INFO - Tokenizing datasets
Map:   0%|          | 0/9159 [00:00<?, ? examples/s]Map:  22%|██▏       | 2000/9159 [00:00<00:00, 12091.25 examples/s]Map:  44%|████▎     | 4000/9159 [00:00<00:00, 13403.71 examples/s]Map:  66%|██████▌   | 6000/9159 [00:00<00:00, 13734.16 examples/s]Map:  87%|████████▋ | 8000/9159 [00:00<00:00, 13812.10 examples/s]Map: 100%|██████████| 9159/9159 [00:00<00:00, 13633.52 examples/s]
Map:   0%|          | 0/1962 [00:00<?, ? examples/s]Map: 100%|██████████| 1962/1962 [00:00<00:00, 14236.38 examples/s]Map: 100%|██████████| 1962/1962 [00:00<00:00, 13990.71 examples/s]
2025-10-17 02:25:34,126 - chatbot_analytics.src.models.intent_classifier - INFO - Training model...
  0%|          | 0/1719 [00:00<?, ?it/s]/Users/Development/chatbotAnalyticsLab/venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  0%|          | 1/1719 [00:17<8:10:28, 17.13s/it]Error: command buffer exited with error status.
	The Metal Performance Shaders operations encoded on it may not have completed.
	Error: 
	(null)
	Insufficient Memory (00000008:kIOGPUCommandBufferCallbackErrorOutOfMemory)
	<AGXG15GFamilyCommandBuffer: 0xaf01e4380>
    label = <none> 
    device = <AGXG15GDevice: 0x1014727a0>
        name = Apple M3 
    commandQueue = <AGXG15GFamilyCommandQueue: 0x101474ae0>
        label = <none> 
        device = <AGXG15GDevice: 0x1014727a0>
            name = Apple M3 
    retainedReferences = 1
  0%|          | 2/1719 [00:41<10:14:32, 21.47s/it]Error: command buffer exited with error status.
	The Metal Performance Shaders operations encoded on it may not have completed.
	Error: 
	(null)
	Insufficient Memory (00000008:kIOGPUCommandBufferCallbackErrorOutOfMemory)
	<AGXG15GFamilyCommandBuffer: 0xaf136d500>
    label = <none> 
    device = <AGXG15GDevice: 0x1014727a0>
        name = Apple M3 
    commandQueue = <AGXG15GFamilyCommandQueue: 0x101474ae0>
        label = <none> 
        device = <AGXG15GDevice: 0x1014727a0>
            name = Apple M3 
    retainedReferences = 1
  0%|          | 3/1719 [01:29<16:00:30, 33.58s/it]Error: command buffer exited with error status.
	The Metal Performance Shaders operations encoded on it may not have completed.
	Error: 
	(null)
	Insufficient Memory (00000008:kIOGPUCommandBufferCallbackErrorOutOfMemory)
	<AGXG15GFamilyCommandBuffer: 0xaf13b3100>
    label = <none> 
    device = <AGXG15GDevice: 0x1014727a0>
        name = Apple M3 
    commandQueue = <AGXG15GFamilyCommandQueue: 0x101474ae0>
        label = <none> 
        device = <AGXG15GDevice: 0x1014727a0>
            name = Apple M3 
    retainedReferences = 1
  0%|          | 4/1719 [02:14<18:06:08, 38.00s/it]Error: command buffer exited with error status.
	The Metal Performance Shaders operations encoded on it may not have completed.
	Error: 
	(null)
	Insufficient Memory (00000008:kIOGPUCommandBufferCallbackErrorOutOfMemory)
	<AGXG15GFamilyCommandBuffer: 0xaf13b3b80>
    label = <none> 
    device = <AGXG15GDevice: 0x1014727a0>
        name = Apple M3 
    commandQueue = <AGXG15GFamilyCommandQueue: 0x101474ae0>
        label = <none> 
        device = <AGXG15GDevice: 0x1014727a0>
            name = Apple M3 
    retainedReferences = 1
  0%|          | 5/1719 [02:50<17:47:07, 37.36s/it]Error: command buffer exited with error status.
	The Metal Performance Shaders operations encoded on it may not have completed.
	Error: 
	(null)
	Insufficient Memory (00000008:kIOGPUCommandBufferCallbackErrorOutOfMemory)
	<AGXG15GFamilyCommandBuffer: 0xaf01e7480>
    label = <none> 
    device = <AGXG15GDevice: 0x1014727a0>
        name = Apple M3 
    commandQueue = <AGXG15GFamilyCommandQueue: 0x101474ae0>
        label = <none> 
        device = <AGXG15GDevice: 0x1014727a0>
            name = Apple M3 
    retainedReferences = 1
